#!/usr/bin/env python3
import sys
import os
sys.path.append(os.path.dirname(os.path.dirname(os.path.realpath(__file__))))
import pseudon_python
import pseudon_python.errors
import yaml

def z():
    if len(sys.argv) == 1:
        print('pseudon-python <filename>')
        return

    filename = sys.argv[1]
    with open(filename, 'r') as f:
        source = f.read()
    try:
        clj = yaml.dump(pseudon.translate(source))
        base = filename.rpartition('.')[0]
        with open('%s.pseudon.yaml' % base, 'w') as f:
            f.write(clj)
    except pseudon.errors.PseudonPythonNotTranslatableError as e:
        print(e)

if __name__ == '__main__':
    z()
